---
name: Financial Transaction
field_name_base_url: http://hl7.org/fhir/r4/Basic
fields:
- name: resourceType
  required: 'Yes'
  cardinality: 1..1
  type: string
  description: The type of the FHIR resource.
  action: create
  example: |
    {
      "resourceType": "Basic"
    }
  note: resourceType must be Basic
  url: http://hl7.org/fhir/r4/json.html#resources

- name: identifier
  required: 'Yes'
  cardinality: 0..*
  type: Identifier
  action: create
  description: Identifier assigned to the resource for business purposes.
  example: |
    {
      "identifier": [
        {
            "value": "33358000",
            "use": "usual"
        }
      ]
    }
  note: At least one external transaction identifier must be provided.
  url: http://hl7.org/fhir/basic-definitions.html#Basic.identifier

- name: code
  required: 'Yes'
  cardinality: 1..1
  type: code
  description: Identifies the 'type' of resource - equivalent to the resource name for other resources.
  action: create
  example: |
    {
      "code": "FinancialTransaction"
    }
  note: This will always be FinancialTransaction
  url: http://hl7.org/fhir/r4/basic-definitions.html#Basic.code

- name: financial-transaction-type
  required: 'Yes'
  cardinality: 1..1
  type: CodeableConcept
  description: Category of transaction Payment Type Codes (Example), Whether this is a payment or adjustment.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-type",
      "valueCode": "CodeableConcept"
    }
  note: Will only accept payment or adjustment
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-type

- name: financial-transaction-alias
  required: 'Yes'
  cardinality: 1..1
  type: string
  description: The aliases used to create the FinancialTransaction resources.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-alias",
      "valueString": "3100"
    }
  note: A value that correlates to a client defined name which represents the combination of the type, subtype, and reason describing the FinancialTransaction. Is required to create al FinancialTransaction resource
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-alias

- name: financial-transaction-location
  required: 'No'
  cardinality: 0..1
  type: string
  description: The location where the payment was collected.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-location",
      "valueString": "201802160003"
    }
  note: These are client configured location values.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-location

- name: financial-transaction-method
  required: 'No'
  cardinality: 0..1
  type: CodeableConcept
  description: The method of payment.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-method",
      "valueCodeableConcept": {
          "coding": [
              {
                  "code": "CHCK",
                    "display": "Check",
                    "system": "http://terminology.hl7.org/CodeSystem/v2-0570",
                    "userSelected": true
              }
          ],
          "text": "Check"
      }
    }
  note: Required on payment transactions. Payment methods of Cash, Credit Card, Check, Cashier’s Check and Traveler’s Check will be supported for FinancialTransaction creates.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-method

- name: financial-transaction-card-brand
  required: 'No'
  cardinality: 0..1
  type: string
  description: The brand of credit card used for the transaction.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-card-brand",
      "valueString": "VISA"
    }
  note: Required on payment transactions when method is Credit Card. Acceptable values are “VISA”, “MASTER”, “AMEX”, “DISCOVER”.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-card-brand

- name: financial-transaction-account-number
  required: 'C'
  cardinality: 0..1
  type: string
  description: The last four digits of the credit card or the check number used for the transaction.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-account-number",
      "valueString": "1234"
    }
  note: Required on payment transactions when method is Credit Card, Check, Cashier’s Check, Traveler’s Check and Money Order. Value must be numeric.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-account-number

- name: financial-transaction-date
  required: 'No'
  cardinality: 0..1
  type: date
  description: Expiration date if method is credit card | check date if method is check
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-date",
      "valueDate": "2020-02-01"
    }
  note: Required on payment transactions when method is Credit Card, Check, Cashier’s Check and Traveler’s Check.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-date

- name: financial-transaction-tendered-amount
  required: 'No'
  cardinality: 0..1
  type: Money
  description: Tendered amount of the cash payment.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-tendered-amount",
      "valueMoney": {
          "value": "123000",
          "currency": {
              "coding": [
                  {
                      "system": "urn:iso:std:iso:4217",
                      "code": "USD",
                      "display": "United States Dollar",
                      "userSelected": true
                  }
              ],
              "text": "United States Dollar"
          }
      }
    }
  note: Should be greater than or equal to the value of the financial-transaction-amount. Required on payment transactions when method is Cash.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-tendered-amount

- name: financial-transaction-amount
  required: 'Yes'
  cardinality: 0..1
  type: Money
  description: The total amount of the FinancialTransaction resource.
  action: create
  example: |
    {
        "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-amount",
        "valueMoney": {
            "value": "123000",
            "currency": {
                "coding": [
                    {
                        "system": "urn:iso:std:iso:4217",
                        "code": "USD",
                        "display": "United States Dollar",
                        "userSelected": true
                    }
                ],
                "text": "United States Dollar"
            }
        }
    }
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-amount

- name: financial-transaction-allocation
  required: 'Yes'
  cardinality: 1..1
  type: Extension
  description: How the FinancialTransaction should be applied.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-allocation",
      "extension": [
          {
              "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-target",
              "valueReference": {
                  "reference": "Encounter/31363178"
              }
          },
          {
              "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-amount",
              "valueMoney": {
                  "value": "400000",
                  "currency": {
                      "coding": [
                          {
                              "system": "urn:iso:std:iso:4217",
                              "code": "USD",
                              "display": "United States Dollar",
                              "userSelected": true
                          }
                      ],
                      "text": "United States Dollar"
                  }
              }
          }
      ]
    }
  note: Only the first allocation element will be used when creating the resource for this initial release.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-allocation

- name: financial-transaction-target
  required: 'Yes'
  cardinality: 1..1
  type: Reference
  description: The specific target the FinancialTransaction should be posted to.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-target",
      "valueReference": {
            "reference": "Encounter/31363178"
      		}
    }
  note: Encounter will be the only posting level target that will be supported for this initial release.
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-target

- name: financial-transaction-amount
  required: 'Yes'
  cardinality: 1..1
  type: Money
  description: The amount of the Financial Transaction that is to be allocated to the specific target.
  action: create
  example: |
    {
      "url": "https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-amount",
      "valueMoney": {
            "value": "400000",
            "currency": {
                "coding": [
                    {
                        "system": "urn:iso:std:iso:4217",
                        "code": "USD",
                        "display": "United States Dollar",
                        "userSelected": true
                    }
                ],
                "text": "United States Dollar"
            }
        }
    }
  url: https://fhir-ehr.cerner.com/r4/StructureDefinition/financial-transaction-amount